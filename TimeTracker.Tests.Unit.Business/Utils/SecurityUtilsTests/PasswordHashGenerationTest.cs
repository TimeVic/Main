using System.Text;
using TimeTracker.Business.Common.Utils;

namespace TimeTracker.Tests.Unit.Business.Utils.SecurityUtilsTests
{
    public class PasswordHashGenerationTest
    {
        [Theory]
        [InlineData("test", "testSalt", "sKFanP+x71smsIdDT2m86Ha5NdDEbrU13Qp1UJerCwQ6dE3uiBvhdGWo6doYb/EUqHJi9qjUVFmzvRhgyvzJJvO8ufUYuu2fP2Se6fQiLQBPZmC0Nx3YhtzqiwigxXnxAjXP9Hy80RGyRMLsL5kvblR+kphXVV7htNe9SBj6Ui8JZNAmge9YlMuM7jyhcbJDc0/tgyJQxeIxQ3O+4/ITaLKUxr6peqaslNEbmeiux+GtQrKo5b3CgVfDft7A6XGMs/96iHRq1JSXd4uv8ATKpxE4qlkyixun8xO8ztdLd+xEZ20v3HwJOcXw5005NSIh0nhrS+lrSQOyuS+ziOtmIk0I4L/UfhV9Jz/gruy26vQhNuXC4P4JEKAIeg21P3S9FugXW9UdnFC3cD3bogcBSMibo+X3/GDv898mnynzO1p4c8Oncyy2zoLGGI8BTHQ5eH3xA0gSfC6Jzq2lL7/d50VEeqe69wjOzx4NlpM5fqWRwEieBIBfdmvaZttEU6lrioq0jKvF43mBTHv+HmyVNCZF2Zq7UYf9m1KooaqSLKHHM1Luq1dZhYDyhYqHFRTDNBoxZDneWsSEatWqFfTBkZwPK+gqV/KgYZNqgzeVwZVYPqKWd1gnwpNPVzMXf1BH+n57oyYoaGE1CsNA9fGQQt1q2FcQ5AY2txclUSMy90EPTHCjFyKn6SgB4ErwpgZldcHX62+x5tVDnMXDsQHdkihGsOF+jnHCUgM3x2TYhbG8/vzzwb5P1bqzDhviF68jA08M9Ao4AGJWIIdrzTAxNP7t0V54WBcj4s55CKxEhGd4WEVwoncB1i4Qp2EN0fad6akDXqOt6Ejb50uuuLUdaxqynnZWbmisNZ6QUOEA8kKFDBuFhvmaq+XCkelT8IE/q/ABu64kmdtjdxFAtjt2SKIGV0L0SI9Rv9Ny7DVAYGIN8ADQRA0++H8Hz/1uoQ7Sn+J/qCrfkwy/HTaOaKI68JAf2HnFFANVUG8rrv9dcQTNynJGinyD7ugHAqjcaPnPBZeKeiSKU9HzKW3mXZAWO0APqJBRu52mH+iwbAy1WF85n2Hw96hCUhU+2FTFNmBJeaGr/glD4sPBLtorzCzEIWPBmwjlqE9dySQarxUXjEIl83HtLxx1IjoCcIoX6tCndDVJS5Xhz07PIDxHhiRUVDNvLLCbf5BuwR+ym5tyIrAUphkjB4la32DRdSWOWr0+C6tIyx6jW6YSG8JotVZhgYpatDunf+vDq4iuTLjZBmHe+kaBt8N6EKExJjAlCenKd7PpkBx2z4CcwzF14jQTyx1IDn0AcZZjh3o5nB2ghm9MZX4JJUGEcVjVHGlsYh/xO6ZrF1mJT0Ve8HUAMwTq")]
        [InlineData("D0YqmyTVocuiqkvs", "Z5HWGD66KWxKeIZr", "qa8H9+3vW+F6UZx9+0SxsIt/CAIrC9tfN+l4EYPAO5WCjnouxm92vHN5ij1XELv1gjyjAbvm6RjmEMYXYDKD8oOoHmINDZaOecPO57k3AoqZvmqTCsAHLDPpkl5QqBTQF/0GJIe5dmCQjlfW3gxJXRxyz1dN6AvpWnc+ctZHwkymtM0kf+FDT70MnByN91uaFlUqkiRB0cu/idQtXAW6Ov6j9TFnuJzGAXxM6IEp0K8HiDjT7olXuGCEbmGhvltIRM3KzIHfggKUpkm7UYfugxzs1/vdafIALcwY4RX9wGN1UBoaRvLwvDLdQ5+g6U4o8izKOOeyNy5EdsWupdEjD6Tnff+wK7IXNFTLqlrj6v7FKE1nEK+Gmuhys3Up+TBqa10eZXESgXfH5N1EGTPra4PdBAGhdABn/nHSDkEjG3izO65IPSCRHP+cllj1wIOqFZKoD4gapHY8DVy/UpOUB+CNtmH63bIlGm1PrSO8DFrcD086fBhE965xS6TYL3Junj+O4kuR/HYLhDj4n+hbnuQPOAdfQeYgDmJ7jF5rrwmUUxel9xHTgog6AzK0KxyNTnusakhylGDjL3KXtIyiueM9bO/k+AGWdyAccUv10IHNRstF5jyEmIoujkdsjdn+EBuYU4ysZ4I7nrTDFsbr6dXtdBAAiRiTmiMivGOxdsMeA/Ymnq8nu5BCrPCDIaldTzt4+VNFijv8m2DUIETEbkhs/R9H77w0A2za4Oh6XAci4m8dAVFX0WRHt333pZ+w5iCaJcIsKFbbhPHM+x55WWS64fu143r1i4d9qq2GdrP/uNO79AbIgUxBnnDE0p3P4BeeTepGE9sbgXzWVnI7WVwJpSwqlJRQgnBHWzspLm0Oy5bbqmaKvXJk7Fi/eXYjQBmFSaolHplsgcqcy7fJ0oXaIcpgxFbenxg1GTnNiNQUU05bNAAqoVUgF5673CqLkOlzBB8WygGIsyTFvpJj0yU4FRVZZ1nev3yOlXDVvA1fFUut9TtoGe1zAqClo1+u2pek318LjALv51yeIPMkT5usl9FaDFkVxzgm7zZrl5RqnpHDxP+vx2F7DIW67JnwPTjheCnlLgzVzpSEanV5w8ge2EOAS8fj3cCVf5SMIWfCpKUorZRfN5XjYzYy2W0ZUuK5+hta1Zk2XFWJohlNkzj+s/iq0cCCewrtBVpUl5nf24Ez/8TIPm3MuX863EmEKZAjCKGpP5y4QHRTQSqDFxw+tejSmEk5+Lrh1fCuRXvfkerboOGFldXSDX5jr98+tzLP2puNkCJnp+t27aE5Zmm6y5FblF3qpHMNjedC85r5bGVPwE39+GgUlD2AecGQ3lwJ9HM3TqYFDZMMmOoW")]
        [InlineData("HJ14rlm1uYPsrPSu", "4QazLMVbGdrGGMCt", "gNw86P+higyf8NP5ttIy8C72oEJwD7KAoxz2IHdUrzi1Xwtcucj6CJtgPfZJrtQZtQrObzRFvUN42xQqwkyWGMEqo4LyK+v3hFsn2aE+mA3ybu3Y3Z630VozLkgnYfLQiEatctBAsvpMLMcfozKiTfQOvxtv0m9zkospw5zSayq0A1jZcEESIH9QYOGESN8jCiT2dSWy5VpxzgsB/b8VPMwZLDmYtRR80T4gClozVmc68vOmOycd7WdCZbZr4eq64AHhMPOohA2IYkHoc32GH+mCuah/USbZ3CGazEad43TFGebiRPvaUv0PEWtZBenDtwlj5i2Ug4KNA6dzYjALyprsmDQxeVe4NOMcT4MWdaS8yxr+NDc0MqMOVBnfUxthgpH2K4i3bOGRw2XOo/G1ixxXazdQXsDQrg32Y+5pGcZF9X7JMvyDQ3ONjSuHdhx4BmrW9O76pI8HhV5/DZ0QtYF3Gq/DTZec59VI4BHtxte0ZPhLuVz3WZL8enMUEtYzCMbD/jKHULF5WwEiHftMU8l0lxIc57uuh7vsO11vPDyrK+GVmBbYPiaoqSF46QXOc/GE6gdhbgDLg62ZAWEJG/+6eFSFk4XDoL+34X8qtwQY9AZGxpZhCg01iySRudp4CKJ1itGBiHObSD3JWdUrESSxJyv7gaRXyHbHiDqOfpnCEWdH8cL4NVSNEbS3RSvvhV0JksPm2dpLrtRuQF1zGBcQ8hE2B6VXNrFK9XrHFXzgetqf+pzpP3pYgxs6CEdIyfuifpCAWMicnGEEpD3ooeZ2bTizKD5wuK5o8RMmf6NG+vbft4B4rxEjcWAx4zpsuH+g1qfOpSa2AVrizgPTAailMSaq1CHTVI2Od+pXrab6nbSp0cscw3rhkv7a2Mqrz0zgmQGyy9GIjS2332XpFRLQ4H3BCI4Wcl5IZELYjT1K95UdDK4d7Hv55gbKX3Q+2aY6kgNZU0XmsKSLb8lNsMrsW1x8CS+kFgWhYZMwq7L+TCENOqzf+wSUtHyWuw6TbEPSZt9W4ji8Zp/ktVlJtwgc8J/JD/RBU9DyEN4JSMONbI0TC1CNiCXKNgy0lK2n2lpCiFWKBio3JJw1msX0FrMRCPtVTuK0se0WbIMAas7RXlWkXIHaO3B3qOz2myYDCQt1t+Wae++XTKj+JkQyF3C4bt42ofpwvt5GHZgcTugnpRfaUTOv69EMh1bxH5QIFVQMjrLh39NBpZZhMqleOwOrqXLVZl7vvyS6H0DeAOArWNshVXyKkQjwxgXcSV7xX/VsMmoazMhvkBYafD+qM4XagBtLP8SZA/5dGPmtV6mL2mrAAhId/cC/vN6V6crMlzs5uJbyk6rCummaCF8c")]
        public void ShouldGeneratePasswordHash(string password, string salt, string expectedHashBase64)
        {
            var hashBytes = SecurityUtil.GeneratePasswordHash(
                password,
                Encoding.UTF8.GetBytes(salt)
            );
            var bytesBase64 = Convert.ToBase64String(hashBytes);
            Assert.Equal(expectedHashBase64, bytesBase64);
        }
    }
}
